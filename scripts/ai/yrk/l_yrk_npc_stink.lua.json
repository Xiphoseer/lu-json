{"type":"Chunk","body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"o_mis","raw":"'o_mis'"}]}},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"CONSTANTS"}],"init":[{"type":"TableConstructorExpression","fields":[]}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DestinkDuration","raw":"\"DestinkDuration\""}}],"init":[{"type":"NumericLiteral","value":4,"raw":"4.0"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"RolloverDuration","raw":"\"RolloverDuration\""}}],"init":[{"type":"NumericLiteral","value":0.2,"raw":"0.2"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"BROOMBOT_LOT","raw":"\"BROOMBOT_LOT\""}}],"init":[{"type":"NumericLiteral","value":3247,"raw":"3247"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"bubbleradius","raw":"\"bubbleradius\""}}],"init":[{"type":"NumericLiteral","value":2,"raw":"2.0"}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onStartup"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetProximityRadius"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"radius"},"value":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"bubbleradius","raw":"\"bubbleradius\""}}}]}}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onProximityUpdate"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"LogicalExpression","operator":"and","left":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"status"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"ENTER","raw":"\"ENTER\""}},"right":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"faction"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetFaction"},"base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objId"},"base":{"type":"Identifier","name":"msg"}}},"arguments":[]}},"right":{"type":"NumericLiteral","value":1,"raw":"1"}}},"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"bPlayerInBubble"}],"init":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"bBubble"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"IsMiniFigInABubble"},"base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objId"},"base":{"type":"Identifier","name":"msg"}}},"arguments":[]}}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"Identifier","name":"bPlayerInBubble","inParens":true},"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"currencyMsg"}],"init":[{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"RollCurrency"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iTable"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"iLevel"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}}]}}]},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"DropLoot"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iCurrency"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"iCurrency"},"base":{"type":"Identifier","name":"currencyMsg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"owner"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objId"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"rerouteID"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objId"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"sourceObj"},"value":{"type":"Identifier","name":"self"}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"Die"},"base":{"type":"Identifier","name":"self"}},"arguments":[]}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"NotifyObject"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetZoneControlID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"stink_cloud_cleaned_by_player","raw":"\"stink_cloud_cleaned_by_player\""}},{"type":"TableKeyString","key":{"type":"Identifier","name":"ObjIDSender"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objId"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"param1"},"value":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"StinkCloudNum","raw":"\"StinkCloudNum\""}]}}]}}}]}]}]}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onSquirtWithWatergun"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objtemplate"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetLOT"},"base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}}},"arguments":[]}},"right":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"BROOMBOT_LOT","raw":"\"BROOMBOT_LOT\""}},"inParens":true},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"AddTimerWithCancel"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetTimer"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}},"arguments":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DestinkDuration","raw":"\"DestinkDuration\""}},{"type":"StringLiteral","value":"RemoveSelf","raw":"\"RemoveSelf\""},{"type":"Identifier","name":"self"}]}},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"player"}],"init":[{"type":"CallExpression","base":{"type":"Identifier","name":"getObjectByName"},"arguments":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}},{"type":"StringLiteral","value":"playerBuilder","raw":"\"playerBuilder\""}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"Identifier","name":"player","inParens":true},"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"NotifyObject"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetZoneControlID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"stink_cloud_cleaned_by_player","raw":"\"stink_cloud_cleaned_by_player\""}},{"type":"TableKeyString","key":{"type":"Identifier","name":"ObjIDSender"},"value":{"type":"Identifier","name":"player"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"param1"},"value":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"StinkCloudNum","raw":"\"StinkCloudNum\""}]}}]}}}]},{"type":"ElseClause","body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"NotifyObject"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetZoneControlID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"stink_cloud_cleaned_by_broombot","raw":"\"stink_cloud_cleaned_by_broombot\""}},{"type":"TableKeyString","key":{"type":"Identifier","name":"ObjIDSender"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"param1"},"value":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"StinkCloudNum","raw":"\"StinkCloudNum\""}]}}]}}}]}]}]},{"type":"ElseClause","body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"UpdateMissionTask"},"base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"target"},"value":{"type":"Identifier","name":"self"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"value"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"value2"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"taskType"},"value":{"type":"StringLiteral","value":"kill","raw":"\"kill\""}}]}}},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"currencyMsg"}],"init":[{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"RollCurrency"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iTable"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"iLevel"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}}]}}]},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"DropLoot"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iCurrency"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"iCurrency"},"base":{"type":"Identifier","name":"currencyMsg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"owner"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"rerouteID"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"sourceObj"},"value":{"type":"Identifier","name":"self"}}]}}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"NotifyObject"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetZoneControlID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"stink_cloud_cleaned_by_player","raw":"\"stink_cloud_cleaned_by_player\""}},{"type":"TableKeyString","key":{"type":"Identifier","name":"ObjIDSender"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"shooterID"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"param1"},"value":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"StinkCloudNum","raw":"\"StinkCloudNum\""}]}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"Die"},"base":{"type":"Identifier","name":"self"}},"arguments":[]}}]}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onTimerDone"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"RemoveSelf","raw":"\"RemoveSelf\""},"inParens":true},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"Die"},"base":{"type":"Identifier","name":"self"}},"arguments":[]}}]}]}]}],"comments":[{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" (SERVER SIDE) Script for stink cloud NPCs","raw":"-- (SERVER SIDE) Script for stink cloud NPCs"},{"type":"Comment","value":"","raw":"--"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" Locals and Constants","raw":"-- Locals and Constants"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" if it's a player","raw":"-- if it's a player"},{"type":"Comment","value":" check for player in bubble, clean stink cloud as a result","raw":"-- check for player in bubble, clean stink cloud as a result"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" Called when this object is destinked","raw":"-- Called when this object is destinked"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" if the shooter is a broom bot","raw":"-- if the shooter is a broom bot"},{"type":"Comment","value":" delay to match animation","raw":"-- delay to match animation"},{"type":"Comment","value":" @TODO: forward player owned broombot info","raw":"-- @TODO: forward player owned broombot info"},{"type":"Comment","value":" see if this broombot was built by a player","raw":"-- see if this broombot was built by a player"},{"type":"Comment","value":" Tell the zone script a stink cloud was cleaned. Pass who cleaned it and the skunk number","raw":"-- Tell the zone script a stink cloud was cleaned. Pass who cleaned it and the skunk number"},{"type":"Comment","value":" Tell the zone script a stink cloud was cleaned. Pass who cleaned it and the skunk number","raw":"-- Tell the zone script a stink cloud was cleaned. Pass who cleaned it and the skunk number"},{"type":"Comment","value":" @TODO: update player task for missions","raw":"-- @TODO: update player task for missions"},{"type":"Comment","value":"this is hacky and not the right way we should be doing this, but it works, non the less","raw":"--this is hacky and not the right way we should be doing this, but it works, non the less"},{"type":"Comment","value":" Using the \"Kill\" mission type in the DB, we are able to update the mission through the objects by calling","raw":"-- Using the \"Kill\" mission type in the DB, we are able to update the mission through the objects by calling"},{"type":"Comment","value":"the \"kill\" tasktype with calues of one.  The downfall is that this will only allow one mission on the designated objects that","raw":"--the \"kill\" tasktype with calues of one.  The downfall is that this will only allow one mission on the designated objects that"},{"type":"Comment","value":"use the kill type.  The commented out updatemissiontask functions are the way we should be doing this but is broken.","raw":"--use the kill type.  The commented out updatemissiontask functions are the way we should be doing this but is broken."},{"type":"Comment","value":"msg.shooterID:UpdateMissionTask {target = self, value = 166, value2 = 1, taskType = \"complete\"}","raw":"--msg.shooterID:UpdateMissionTask {target = self, value = 166, value2 = 1, taskType = \"complete\"}"},{"type":"Comment","value":" msg.shooterID:UpdateMissionTask {target = self, value = 167, value2 = 1, taskType = \"complete\"}","raw":"-- msg.shooterID:UpdateMissionTask {target = self, value = 167, value2 = 1, taskType = \"complete\"}"},{"type":"Comment","value":"msg.shooterID:UpdateMissionTask {target = self, value = 168, value2 = 1, taskType = \"complete\"}","raw":"--msg.shooterID:UpdateMissionTask {target = self, value = 168, value2 = 1, taskType = \"complete\"}"},{"type":"Comment","value":" Tell the zone script a stink cloud was cleaned. Pass who cleaned it and the skunk number","raw":"-- Tell the zone script a stink cloud was cleaned. Pass who cleaned it and the skunk number"},{"type":"Comment","value":" else this is the player so kill it instantly","raw":"-- else this is the player so kill it instantly"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" called when timer complete","raw":"-- called when timer complete"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" cleaned by a broombot","raw":"-- cleaned by a broombot"}]}