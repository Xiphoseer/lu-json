{"type":"Chunk","body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"ProxRadius"}],"init":[{"type":"NumericLiteral","value":75,"raw":"75"}]},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"OuterProxRadius"}],"init":[{"type":"NumericLiteral","value":85,"raw":"85"}]},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"soundName"}],"init":[{"type":"StringLiteral","value":"{9a24f1fa-3177-4745-a2df-fbd996d6e1e3}","raw":"'{9a24f1fa-3177-4745-a2df-fbd996d6e1e3}'"}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onStartup"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"counter","raw":"\"counter\""},{"type":"NumericLiteral","value":0,"raw":"0"}]}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"outerCounter","raw":"\"outerCounter\""},{"type":"NumericLiteral","value":0,"raw":"0"}]}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetProximityRadius"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"radius"},"value":{"type":"Identifier","name":"ProxRadius"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"busDoor","raw":"\"busDoor\""}}]}}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetProximityRadius"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"radius"},"value":{"type":"Identifier","name":"OuterProxRadius"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"busDoorOuter","raw":"\"busDoorOuter\""}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"StopPathing"},"base":{"type":"Identifier","name":"self"}},"arguments":[]}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"moveDoor"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"bOpen"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"Identifier","name":"bOpen"},"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GoToWaypoint"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iPathIndex"},"value":{"type":"NumericLiteral","value":0,"raw":"0"}}]}}}]},{"type":"ElseClause","body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GoToWaypoint"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iPathIndex"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}}]}}}]}]},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"PlayNDAudioEmitter"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"m_NDAudioEventGUID"},"value":{"type":"Identifier","name":"soundName"}}]}}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onProximityUpdate"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"LogicalExpression","operator":"and","left":{"type":"BinaryExpression","operator":"~=","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"busDoor","raw":"\"busDoor\""}},"right":{"type":"BinaryExpression","operator":"~=","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"busDoorOuter","raw":"\"busDoorOuter\""}},"inParens":true},"body":[{"type":"ReturnStatement","arguments":[]}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"UnaryExpression","operator":"not","argument":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"bIsInFaction"},"base":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"BelongsToFaction"},"base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objId"},"base":{"type":"Identifier","name":"msg"}}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"factionID"},"value":{"type":"NumericLiteral","value":1,"raw":"1"}}]}}}},"body":[{"type":"ReturnStatement","arguments":[]}]}]},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"counter"}],"init":[{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"counter","raw":"\"counter\""}]}]},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"outerCounter"}],"init":[{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"outerCounter","raw":"\"outerCounter\""}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"status"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"ENTER","raw":"\"ENTER\""},"inParens":true},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"busDoor","raw":"\"busDoor\""},"inParens":true},"body":[{"type":"AssignmentStatement","variables":[{"type":"Identifier","name":"counter"}],"init":[{"type":"BinaryExpression","operator":"+","left":{"type":"Identifier","name":"counter"},"right":{"type":"NumericLiteral","value":1,"raw":"1"}}]}]},{"type":"ElseifClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"busDoorOuter","raw":"\"busDoorOuter\""},"inParens":true},"body":[{"type":"AssignmentStatement","variables":[{"type":"Identifier","name":"outerCounter"}],"init":[{"type":"BinaryExpression","operator":"+","left":{"type":"Identifier","name":"outerCounter"},"right":{"type":"NumericLiteral","value":1,"raw":"1"}}]}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"LogicalExpression","operator":"and","left":{"type":"BinaryExpression","operator":"==","left":{"type":"Identifier","name":"counter"},"right":{"type":"NumericLiteral","value":1,"raw":"1"}},"right":{"type":"BinaryExpression","operator":">=","left":{"type":"Identifier","name":"outerCounter"},"right":{"type":"NumericLiteral","value":1,"raw":"1"}},"inParens":true},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"moveDoor"},"arguments":[{"type":"Identifier","name":"self"},{"type":"BooleanLiteral","value":true,"raw":"true"}]}}]}]}]},{"type":"ElseifClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"status"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"LEAVE","raw":"\"LEAVE\""},"inParens":true},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"busDoor","raw":"\"busDoor\""},"inParens":true},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":">","left":{"type":"Identifier","name":"counter"},"right":{"type":"NumericLiteral","value":0,"raw":"0"}},"body":[{"type":"AssignmentStatement","variables":[{"type":"Identifier","name":"counter"}],"init":[{"type":"BinaryExpression","operator":"-","left":{"type":"Identifier","name":"counter"},"right":{"type":"NumericLiteral","value":1,"raw":"1"}}]}]}]}]},{"type":"ElseifClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"busDoorOuter","raw":"\"busDoorOuter\""},"inParens":true},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":">","left":{"type":"Identifier","name":"outerCounter"},"right":{"type":"NumericLiteral","value":0,"raw":"0"}},"body":[{"type":"AssignmentStatement","variables":[{"type":"Identifier","name":"outerCounter"}],"init":[{"type":"BinaryExpression","operator":"-","left":{"type":"Identifier","name":"outerCounter"},"right":{"type":"NumericLiteral","value":1,"raw":"1"}}]}]}]}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"LogicalExpression","operator":"and","left":{"type":"BinaryExpression","operator":"==","left":{"type":"Identifier","name":"counter"},"right":{"type":"NumericLiteral","value":0,"raw":"0"}},"right":{"type":"BinaryExpression","operator":"==","left":{"type":"Identifier","name":"outerCounter"},"right":{"type":"NumericLiteral","value":0,"raw":"0"}},"inParens":true},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"moveDoor"},"arguments":[{"type":"Identifier","name":"self"},{"type":"BooleanLiteral","value":false,"raw":"false"}]}}]}]}]}]},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"counter","raw":"\"counter\""},{"type":"Identifier","name":"counter"}]}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetVar"},"base":{"type":"Identifier","name":"self"}},"arguments":[{"type":"StringLiteral","value":"outerCounter","raw":"\"outerCounter\""},{"type":"Identifier","name":"outerCounter"}]}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onArrivedAtDesiredWaypoint"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"iPathIndex"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"NumericLiteral","value":1,"raw":"1"}},"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"PlayFXEffect"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"busDust","raw":"\"busDust\""}},{"type":"TableKeyString","key":{"type":"Identifier","name":"effectType"},"value":{"type":"StringLiteral","value":"create","raw":"\"create\""}}]}}}]}]}]}],"comments":[{"type":"Comment","value":"-- Moves the bus door while players are close to it.","raw":"---- Moves the bus door while players are close to it."},{"type":"Comment","value":"-- Updated: 7/01/09 jnf...","raw":"---- Updated: 7/01/09 jnf..."},{"type":"Comment","value":"-- Updated: 5/19/10 djames... added second proxy radius and outerCounter","raw":"---- Updated: 5/19/10 djames... added second proxy radius and outerCounter"},{"type":"Comment","value":" the logic behind opening and closing the door is based on two proximity radii","raw":"-- the logic behind opening and closing the door is based on two proximity radii"},{"type":"Comment","value":" it is possible for players to leave the proximity sphere unintentionally ","raw":"-- it is possible for players to leave the proximity sphere unintentionally "},{"type":"Comment","value":" when the bus moves up because the sphere moves with the bus","raw":"-- when the bus moves up because the sphere moves with the bus"},{"type":"Comment","value":" by maintaining two counters, for both the inner and outer radii, players will","raw":"-- by maintaining two counters, for both the inner and outer radii, players will"},{"type":"Comment","value":" only be considered \"in\" proximity if they are inside both radii and they will","raw":"-- only be considered \"in\" proximity if they are inside both radii and they will"},{"type":"Comment","value":" only be considered \"out\" of proximity if they are outside both radii","raw":"-- only be considered \"out\" of proximity if they are outside both radii"},{"type":"Comment","value":" the radius for \"inner\" proximity detection","raw":"-- the radius for \"inner\" proximity detection"},{"type":"Comment","value":" the radius for \"outer\" proximity detection","raw":"-- the radius for \"outer\" proximity detection"},{"type":"Comment","value":"print('move door **************')","raw":"--print('move door **************')"},{"type":"Comment","value":"print('open door **************')","raw":"--print('open door **************')"},{"type":"Comment","value":"print('close door **************')","raw":"--print('close door **************')"},{"type":"Comment","value":" If this isn't the proximity radius for the bus door behavior, then we're done here","raw":"-- If this isn't the proximity radius for the bus door behavior, then we're done here"},{"type":"Comment","value":" Make sure only humans are taken into account","raw":"-- Make sure only humans are taken into account"},{"type":"Comment","value":" move up when a player is inside both radii","raw":"-- move up when a player is inside both radii"},{"type":"Comment","value":" move down when no players are inside either radii","raw":"-- move down when no players are inside either radii"},{"type":"Comment","value":"print('proximity update: status='..msg.status..', name='..msg.name..', counter='..counter..', outerCounter='..outerCounter)","raw":"--print('proximity update: status='..msg.status..', name='..msg.name..', counter='..counter..', outerCounter='..outerCounter)"},{"type":"Comment","value":" effectID = 642, ","raw":"-- effectID = 642, "},{"type":"Comment","value":"print('play effect busDust')","raw":"--print('play effect busDust')"}]}