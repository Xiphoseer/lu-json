{"type":"Chunk","body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"require"},"arguments":[{"type":"StringLiteral","value":"ai/ACT/L_ACT_GENERIC_ACTIVITY_MGR","raw":"'ai/ACT/L_ACT_GENERIC_ACTIVITY_MGR'"}]}},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onStartup"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"zControl"}],"init":[{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetZoneControlID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}]},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"AddObjectToGroup"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"group"},"value":{"type":"StringLiteral","value":"FootRaceStarter","raw":"\"FootRaceStarter\""}}]}}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SendLuaNotificationRequest"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"requestTarget"},"value":{"type":"Identifier","name":"zControl"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"messageName"},"value":{"type":"StringLiteral","value":"PlayerExit","raw":"\"PlayerExit\""}}]}}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onShutdown"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SendLuaNotificationCancel"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"requestTarget"},"value":{"type":"Identifier","name":"zControl"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"messageName"},"value":{"type":"StringLiteral","value":"PlayerExit","raw":"\"PlayerExit\""}}]}}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onFireEventServerSide"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"tArgs"}],"init":[{"type":"CallExpression","base":{"type":"Identifier","name":"split"},"arguments":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"args"},"base":{"type":"Identifier","name":"msg"}},{"type":"StringLiteral","value":"_","raw":"\"_\""}]}]},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"player"}],"init":[{"type":"BooleanLiteral","value":false,"raw":"false"}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":2,"raw":"2"}},"body":[{"type":"AssignmentStatement","variables":[{"type":"Identifier","name":"player"}],"init":[{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetObjectByID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":2,"raw":"2"}}]}]}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"Identifier","name":"player"},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":1,"raw":"1"}},"right":{"type":"StringLiteral","value":"updatePlayer","raw":"\"updatePlayer\""}},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"UpdatePlayer"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"}]}}]},{"type":"ElseifClause","condition":{"type":"CallExpression","base":{"type":"Identifier","name":"IsPlayerInActivity"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"}]},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":1,"raw":"1"}},"right":{"type":"StringLiteral","value":"initialActivityScore","raw":"\"initialActivityScore\""}},"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetFlag"},"base":{"type":"Identifier","name":"player"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iFlagID"},"value":{"type":"NumericLiteral","value":115,"raw":"115"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"bFlag"},"value":{"type":"BooleanLiteral","value":true,"raw":"true"}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"InitialActivityScore"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"},{"type":"NumericLiteral","value":1,"raw":"1"},{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"param1"},"base":{"type":"Identifier","name":"msg"}}]}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SendLuaNotificationRequest"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"requestTarget"},"value":{"type":"Identifier","name":"player"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"messageName"},"value":{"type":"StringLiteral","value":"PlayerLaunchpadInteract","raw":"\"PlayerLaunchpadInteract\""}}]}}}]},{"type":"ElseifClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":1,"raw":"1"}},"right":{"type":"StringLiteral","value":"updatePlayerTrue","raw":"\"updatePlayerTrue\""}},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"EndActivity"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"}]}}]},{"type":"ElseifClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":1,"raw":"1"}},"right":{"type":"StringLiteral","value":"PlayerWon","raw":"\"PlayerWon\""}},"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"param2"},"base":{"type":"Identifier","name":"msg"}},"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetFlag"},"base":{"type":"Identifier","name":"player"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iFlagID"},"value":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"param2"},"base":{"type":"Identifier","name":"msg"}}},{"type":"TableKeyString","key":{"type":"Identifier","name":"bFlag"},"value":{"type":"BooleanLiteral","value":true,"raw":"true"}}]}}}]}]},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetFlag"},"base":{"type":"Identifier","name":"player"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iFlagID"},"value":{"type":"NumericLiteral","value":115,"raw":"115"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"bFlag"},"value":{"type":"BooleanLiteral","value":false,"raw":"false"}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"StopActivity"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"},{"type":"NumericLiteral","value":0,"raw":"0"},{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"param1"},"base":{"type":"Identifier","name":"msg"}}]}}]}]}]}]}]},{"type":"ElseifClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"IndexExpression","base":{"type":"Identifier","name":"tArgs"},"index":{"type":"NumericLiteral","value":1,"raw":"1"}},"right":{"type":"StringLiteral","value":"setupActivity","raw":"\"setupActivity\""}},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"SetupActivity"},"arguments":[{"type":"Identifier","name":"self"},{"type":"NumericLiteral","value":9999,"raw":"9999"},{"type":"BooleanLiteral","value":true,"raw":"true"}]}}]}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"EndActivity"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"}],"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetFlag"},"base":{"type":"Identifier","name":"player"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"iFlagID"},"value":{"type":"NumericLiteral","value":115,"raw":"115"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"bFlag"},"value":{"type":"BooleanLiteral","value":false,"raw":"false"}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"UpdatePlayer"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"},{"type":"BooleanLiteral","value":true,"raw":"true"}]}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SendLuaNotificationCancel"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"requestTarget"},"value":{"type":"Identifier","name":"player"}},{"type":"TableKeyString","key":{"type":"Identifier","name":"messageName"},"value":{"type":"StringLiteral","value":"PlayerLaunchpadInteract","raw":"\"PlayerLaunchpadInteract\""}}]}}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"notifyPlayerLaunchpadInteract"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"},{"type":"Identifier","name":"msg"}],"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"EndActivity"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"player"}]}},{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"NotifyClientObject"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"name"},"value":{"type":"StringLiteral","value":"stop_timer","raw":"\"stop_timer\""}},{"type":"TableKeyString","key":{"type":"Identifier","name":"reroutID"},"value":{"type":"Identifier","name":"player"}}]}}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"notifyPlayerExit"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"other"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"UnaryExpression","operator":"not","argument":{"type":"CallExpression","base":{"type":"Identifier","name":"IsPlayerInActivity"},"arguments":[{"type":"Identifier","name":"self"},{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"playerID"},"base":{"type":"Identifier","name":"msg"}}]}},"body":[{"type":"ReturnStatement","arguments":[]}]}]},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"UpdatePlayer"},"arguments":[{"type":"Identifier","name":"self"},{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"playerID"},"base":{"type":"Identifier","name":"msg"}},{"type":"BooleanLiteral","value":true,"raw":"true"}]}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onDoCalculateActivityRating"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"AssignmentStatement","variables":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"outActivityRating"},"base":{"type":"Identifier","name":"msg"}}],"init":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"fValue1"},"base":{"type":"Identifier","name":"msg"}}]},{"type":"ReturnStatement","arguments":[{"type":"Identifier","name":"msg"}]}]}],"comments":[{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" Base Server side Foot Race script ","raw":"-- Base Server side Foot Race script "},{"type":"Comment","value":" updated mrb... 10/26/10","raw":"-- updated mrb... 10/26/10"},{"type":"Comment","value":" updated rfurino 7/26/11","raw":"-- updated rfurino 7/26/11"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"print('onFireEventServerSide ' .. msg.args)","raw":"--print('onFireEventServerSide ' .. msg.args)"},{"type":"Comment","value":"UpdatePlayer(self, player, removePlayer)       ","raw":"--UpdatePlayer(self, player, removePlayer)       "},{"type":"Comment","value":" turn on the player flag for is player in foot race","raw":"-- turn on the player flag for is player in foot race"},{"type":"Comment","value":"InitialActivityScore(self, player, scoreVar)   ","raw":"--InitialActivityScore(self, player, scoreVar)   "},{"type":"Comment","value":"print('found player ' .. player:GetName().name .. ' ********')","raw":"--print('found player ' .. player:GetName().name .. ' ********')"},{"type":"Comment","value":" turn off the player flag for is player in foot race","raw":"-- turn off the player flag for is player in foot race"},{"type":"Comment","value":"StopActivity(self, player, scoreVar, value1Var, value2Var, quit )","raw":"--StopActivity(self, player, scoreVar, value1Var, value2Var, quit )"},{"type":"Comment","value":" turn off the player flag for is player in foot race","raw":"-- turn off the player flag for is player in foot race"},{"type":"Comment","value":"UpdatePlayer(self, player, removePlayer)","raw":"--UpdatePlayer(self, player, removePlayer)"},{"type":"Comment","value":"msg also contains senderID (the launch pad itself) and targetID (the player id)","raw":"--msg also contains senderID (the launch pad itself) and targetID (the player id)"},{"type":"Comment","value":" if player logs out remove them from the activity","raw":"-- if player logs out remove them from the activity"},{"type":"Comment","value":"--------------------------------------------------------------","raw":"----------------------------------------------------------------"},{"type":"Comment","value":" When activity is stopped this is needed to update the leaderboard.","raw":"-- When activity is stopped this is needed to update the leaderboard."},{"type":"Comment","value":"--------------------------------------------------------------","raw":"----------------------------------------------------------------"}]}