{"type":"Chunk","body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"CONSTANTS"}],"init":[{"type":"TableConstructorExpression","fields":[]}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DANCE_ADMIRER_MISSION","raw":"\"DANCE_ADMIRER_MISSION\""}}],"init":[{"type":"NumericLiteral","value":175,"raw":"175"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"CONCERT_FAN_GROUP","raw":"\"CONCERT_FAN_GROUP\""}}],"init":[{"type":"StringLiteral","value":"dance_crowd","raw":"\"dance_crowd\""}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_DWARF","raw":"\"INDEX_DWARF\""}}],"init":[{"type":"NumericLiteral","value":1,"raw":"1"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_FIREFIGHTER","raw":"\"INDEX_FIREFIGHTER\""}}],"init":[{"type":"NumericLiteral","value":2,"raw":"2"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_BREAKDANCE","raw":"\"INDEX_BREAKDANCE\""}}],"init":[{"type":"NumericLiteral","value":3,"raw":"3"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_SKILLZ","raw":"\"INDEX_SKILLZ\""}}],"init":[{"type":"NumericLiteral","value":4,"raw":"4"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}}],"init":[{"type":"TableConstructorExpression","fields":[]}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}},"index":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_DWARF","raw":"\"INDEX_DWARF\""}}}],"init":[{"type":"StringLiteral","value":"headbang","raw":"\"headbang\""}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}},"index":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_FIREFIGHTER","raw":"\"INDEX_FIREFIGHTER\""}}}],"init":[{"type":"StringLiteral","value":"hat-dance","raw":"\"hat-dance\""}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}},"index":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"INDEX_BREAKDANCE","raw":"\"INDEX_BREAKDANCE\""}}}],"init":[{"type":"StringLiteral","value":"breakdance","raw":"\"breakdance\""}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_RECHECK_DELAY","raw":"\"DISCO_RECHECK_DELAY\""}}],"init":[{"type":"NumericLiteral","value":1,"raw":"1.0"}]},{"type":"AssignmentStatement","variables":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_RADIUS","raw":"\"DISCO_RADIUS\""}}],"init":[{"type":"NumericLiteral","value":30,"raw":"30"}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onStartup"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"SetProximityRadius"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"radius"},"value":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_RADIUS","raw":"\"DISCO_RADIUS\""}}}]}}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"SetTimerToCheckProximity"},"arguments":[{"type":"Identifier","name":"self"}]}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"SetTimerToCheckProximity"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"AddTimerWithCancel"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetTimer"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]}},"arguments":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_RECHECK_DELAY","raw":"\"DISCO_RECHECK_DELAY\""}},{"type":"StringLiteral","value":"checkProximity","raw":"\"checkProximity\""},{"type":"Identifier","name":"self"}]}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"onTimerDone"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"msg"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"name"},"base":{"type":"Identifier","name":"msg"}},"right":{"type":"StringLiteral","value":"checkProximity","raw":"\"checkProximity\""},"inParens":true},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"CheckProximity"},"arguments":[{"type":"Identifier","name":"self"}]}},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"SetTimerToCheckProximity"},"arguments":[{"type":"Identifier","name":"self"}]}}]}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"CheckProximity"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"proxObjs"}],"init":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objects"},"base":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetProximityObjects"},"base":{"type":"Identifier","name":"self"}},"arguments":[]}}]},{"type":"ForNumericStatement","variable":{"type":"Identifier","name":"i"},"start":{"type":"NumericLiteral","value":1,"raw":"1"},"end":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"maxn"},"base":{"type":"Identifier","name":"table"}},"arguments":[{"type":"Identifier","name":"proxObjs"}]},"step":null,"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"nearbyObj"}],"init":[{"type":"IndexExpression","base":{"type":"Identifier","name":"proxObjs"},"index":{"type":"Identifier","name":"i"}}]},{"type":"LocalStatement","variables":[{"type":"Identifier","name":"emoteNum"}],"init":[{"type":"CallExpression","base":{"type":"Identifier","name":"GetLocalPlayersDanceEmote"},"arguments":[{"type":"Identifier","name":"nearbyObj"}]}]},{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"~=","left":{"type":"Identifier","name":"emoteNum"},"right":{"type":"UnaryExpression","operator":"-","argument":{"type":"NumericLiteral","value":1,"raw":"1"}},"inParens":true},"body":[{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"MakeCrowdDance"},"arguments":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"emoteNum"}]}},{"type":"ReturnStatement","arguments":[]}]}]}]},{"type":"CallStatement","expression":{"type":"CallExpression","base":{"type":"Identifier","name":"MakeCrowdStop"},"arguments":[{"type":"Identifier","name":"self"}]}}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"GetLocalPlayersDanceEmote"},"isLocal":false,"parameters":[{"type":"Identifier","name":"obj"}],"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"BinaryExpression","operator":"==","left":{"type":"CallExpression","base":{"type":"Identifier","name":"IsLocalPlayer"},"arguments":[{"type":"Identifier","name":"obj"}]},"right":{"type":"BooleanLiteral","value":false,"raw":"false"},"inParens":true},"body":[{"type":"ReturnStatement","arguments":[{"type":"UnaryExpression","operator":"-","argument":{"type":"NumericLiteral","value":1,"raw":"1"}}]}]}]},{"type":"ForNumericStatement","variable":{"type":"Identifier","name":"emoteIndex"},"start":{"type":"NumericLiteral","value":1,"raw":"1"},"end":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"maxn"},"base":{"type":"Identifier","name":"table"}},"arguments":[{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}}]},"step":null,"body":[{"type":"IfStatement","clauses":[{"type":"IfClause","condition":{"type":"CallExpression","base":{"type":"Identifier","name":"IsPlayingEmoteAnim"},"arguments":[{"type":"Identifier","name":"obj"},{"type":"IndexExpression","base":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}},"index":{"type":"Identifier","name":"emoteIndex"}}],"inParens":true},"body":[{"type":"ReturnStatement","arguments":[{"type":"IndexExpression","base":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"DISCO_ANIMS","raw":"\"DISCO_ANIMS\""}},"index":{"type":"Identifier","name":"emoteIndex"}}]}]}]}]},{"type":"ReturnStatement","arguments":[{"type":"UnaryExpression","operator":"-","argument":{"type":"NumericLiteral","value":1,"raw":"1"}}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"IsLocalPlayer"},"isLocal":false,"parameters":[{"type":"Identifier","name":"obj"}],"body":[{"type":"ReturnStatement","arguments":[{"type":"BinaryExpression","operator":"==","left":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetID"},"base":{"type":"Identifier","name":"obj"}},"arguments":[]},"right":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetLocalCharID"},"base":{"type":"Identifier","name":"GAMEOBJ"}},"arguments":[]},"inParens":true}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"IsPlayingEmoteAnim"},"isLocal":false,"parameters":[{"type":"Identifier","name":"player"},{"type":"Identifier","name":"anim"}],"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"emoteMsg"}],"init":[{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetCurrentAnimation"},"base":{"type":"Identifier","name":"player"}},"arguments":{"type":"TableConstructorExpression","fields":[]}}]},{"type":"ReturnStatement","arguments":[{"type":"LogicalExpression","operator":"or","left":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"primaryAnimationID"},"base":{"type":"Identifier","name":"emoteMsg"}},"right":{"type":"Identifier","name":"anim"}},"right":{"type":"BinaryExpression","operator":"==","left":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"secondaryAnimationID"},"base":{"type":"Identifier","name":"emoteMsg"}},"right":{"type":"Identifier","name":"anim"}},"inParens":true}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"MakeCrowdDance"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"},{"type":"Identifier","name":"anim"}],"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"crowdObjects"}],"init":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objects"},"base":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetObjectsInGroup"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"group"},"value":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"CONCERT_FAN_GROUP","raw":"\"CONCERT_FAN_GROUP\""}}}]}}}]},{"type":"ForNumericStatement","variable":{"type":"Identifier","name":"i"},"start":{"type":"NumericLiteral","value":1,"raw":"1"},"end":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"maxn"},"base":{"type":"Identifier","name":"table"}},"arguments":[{"type":"Identifier","name":"crowdObjects"}]},"step":null,"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"PlayAnimation"},"base":{"type":"IndexExpression","base":{"type":"Identifier","name":"crowdObjects"},"index":{"type":"Identifier","name":"i"}}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"animationID"},"value":{"type":"Identifier","name":"anim"}}]}}}]}]},{"type":"FunctionDeclaration","identifier":{"type":"Identifier","name":"MakeCrowdStop"},"isLocal":false,"parameters":[{"type":"Identifier","name":"self"}],"body":[{"type":"LocalStatement","variables":[{"type":"Identifier","name":"crowdObjects"}],"init":[{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"objects"},"base":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"GetObjectsInGroup"},"base":{"type":"Identifier","name":"self"}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"group"},"value":{"type":"IndexExpression","base":{"type":"Identifier","name":"CONSTANTS"},"index":{"type":"StringLiteral","value":"CONCERT_FAN_GROUP","raw":"\"CONCERT_FAN_GROUP\""}}}]}}}]},{"type":"ForNumericStatement","variable":{"type":"Identifier","name":"i"},"start":{"type":"NumericLiteral","value":1,"raw":"1"},"end":{"type":"CallExpression","base":{"type":"MemberExpression","indexer":".","identifier":{"type":"Identifier","name":"maxn"},"base":{"type":"Identifier","name":"table"}},"arguments":[{"type":"Identifier","name":"crowdObjects"}]},"step":null,"body":[{"type":"CallStatement","expression":{"type":"TableCallExpression","base":{"type":"MemberExpression","indexer":":","identifier":{"type":"Identifier","name":"PlayAnimation"},"base":{"type":"IndexExpression","base":{"type":"Identifier","name":"crowdObjects"},"index":{"type":"Identifier","name":"i"}}},"arguments":{"type":"TableConstructorExpression","fields":[{"type":"TableKeyString","key":{"type":"Identifier","name":"animationID"},"value":{"type":"StringLiteral","value":"idle","raw":"\"idle\""}}]}}}]}]}],"comments":[{"type":"Comment","value":"-----------------------------------------------------------","raw":"-------------------------------------------------------------"},{"type":"Comment","value":" constants","raw":"-- constants"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" constants for the NPC that wants to see a dance emote","raw":"-- constants for the NPC that wants to see a dance emote"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" the mission number for dancing in front of this NPC","raw":"-- the mission number for dancing in front of this NPC"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" constants for dancing up near the disco ball","raw":"-- constants for dancing up near the disco ball"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" the group an NPC must be assigned to in Happy Flower in order for it to mirror the player's dancing","raw":"-- the group an NPC must be assigned to in Happy Flower in order for it to mirror the player's dancing"},{"type":"Comment","value":" indices for the acceptable dances, same as above","raw":"-- indices for the acceptable dances, same as above"},{"type":"Comment","value":" the corresponding animations (from Emotes table in database)","raw":"-- the corresponding animations (from Emotes table in database)"},{"type":"Comment","value":" emote 207","raw":"-- emote 207"},{"type":"Comment","value":" emote 208","raw":"-- emote 208"},{"type":"Comment","value":" emote 192","raw":"-- emote 192"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" Startup","raw":"-- Startup"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" Set a timer to check whether the player is dancing nearby","raw":"-- Set a timer to check whether the player is dancing nearby"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" Timers","raw":"-- Timers"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" check whether the local player is nearby doing a dance emote","raw":"-- check whether the local player is nearby doing a dance emote"},{"type":"Comment","value":" if so, make the crowd do the same dance","raw":"-- if so, make the crowd do the same dance"},{"type":"Comment","value":" for each item in this NPC's proximity:","raw":"-- for each item in this NPC's proximity:"},{"type":"Comment","value":" first check if it's the local player","raw":"-- first check if it's the local player"},{"type":"Comment","value":" and is playing the corresponding anim","raw":"-- and is playing the corresponding anim"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" get a list of all the objects within proximity","raw":"-- get a list of all the objects within proximity"},{"type":"Comment","value":" go through the list and check each one","raw":"-- go through the list and check each one"},{"type":"Comment","value":" check to see if it's the local player and doing a dance emote","raw":"-- check to see if it's the local player and doing a dance emote"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" returns the name of the dance emote ID that the local player is playing","raw":"-- returns the name of the dance emote ID that the local player is playing"},{"type":"Comment","value":" or -1 if the  local player isn't playing a dance emote nearby","raw":"-- or -1 if the  local player isn't playing a dance emote nearby"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" check if the object is even a player","raw":"-- check if the object is even a player"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" returns whether or not given the obj is the local character","raw":"-- returns whether or not given the obj is the local character"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" returns whether or not the given player is playing the given anim","raw":"-- returns whether or not the given player is playing the given anim"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" any NPC's in the group should play the given anim","raw":"-- any NPC's in the group should play the given anim"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"},{"type":"Comment","value":" any NPC's in the group should play their idles","raw":"-- any NPC's in the group should play their idles"},{"type":"Comment","value":"------------------------------------------------------------","raw":"--------------------------------------------------------------"}]}